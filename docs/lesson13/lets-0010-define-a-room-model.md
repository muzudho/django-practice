# ç›®çš„

ã‚µãƒ¼ãƒãƒ¼ã«ã€éƒ¨å±‹ã‚’è¨˜æ†¶ã—ãŸã„  

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ Lesson01 ã‹ã‚‰é †ã«å…¨éƒ¨ã‚„ã£ã¦ã“ãªã„ã¨ ã‚½ãƒ¼ã‚¹ãŒè¶³ã‚Šãšå®Ÿè¡Œã§ããªã„ã®ã§æ³¨æ„ã•ã‚ŒãŸã„ã€‚  
é€£è¼‰ã®ç›®æ¬¡: ğŸ“– [Djangoã¨Dockerã§ã‚²ãƒ¼ãƒ å¯¾å±€ã‚µãƒ¼ãƒãƒ¼ã‚’ä½œã‚ã†ï¼](https://qiita.com/muzudho1/items/eb0df0ea604e1fd9cdae)  

ã“ã®è¨˜äº‹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:  

| Key       | Value                                     |
| --------- | ----------------------------------------- |
| OS        | Windows10                                 |
| Container | Docker                                    |
| Editor    | Visual Studio Code ï¼ˆä»¥ä¸‹ VSCode ã¨è¡¨è¨˜ï¼‰ |

å‚è€ƒã«ã—ãŸå…ƒè¨˜äº‹ã¯ ğŸ“–[Djangoã§CRUD](https://qiita.com/zaburo/items/ab7f0eeeaec0e60d6b92) ã ã€‚  
ã‚ãŸã—ã®è¨˜äº‹ã¯å˜ã« **ã‚„ã£ã¦ã¿ãŸ** ãã‚‰ã„ã®ä½ç½®ã¥ã‘ã   

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’æŠœç²‹ã™ã‚‹ã¨ ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹  

```plaintext
    â”œâ”€â”€ ğŸ“‚host_local1
    â”‚    â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
    â””â”€â”€ ğŸ“‚host1
        â”œâ”€â”€ ğŸ“‚data
        â”‚   â””â”€â”€ ğŸ“‚db
        â”‚       â””â”€â”€ ï¼ˆãŸãã•ã‚“ã®ã‚‚ã®ï¼‰
        â”œâ”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
        â”‚   â”œâ”€â”€ ğŸ“‚models
        â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“‚static
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚tic-tac-toe
        â”‚   â”‚   â”‚   â”œâ”€â”€ ğŸ“‚v1
        â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
        â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚v2
        â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“„connection.js
        â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“„engine.js
        â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“„game.js
        â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“„judge.js
        â”‚   â”‚   â”‚       â”œâ”€â”€ ğŸ“„protocol_main.js
        â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“„protocol_messages.js
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚vuetify-practice
        â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“„desserts.json
        â”‚   â”‚   â””â”€â”€ ğŸš€favicon.ico
        â”‚   â”œâ”€â”€ ğŸ“‚templates
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚allauth-customized
        â”‚   â”‚   â””â”€â”€ ğŸ“‚webapp1               # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¨åŒã˜åå‰
        â”‚   â”‚       â”œâ”€â”€ ğŸ“‚tic-tac-toe
        â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“‚v1
        â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“‚v2
        â”‚   â”‚       â”‚       â”œâ”€â”€ ğŸ“„portal.html
        â”‚   â”‚       â”‚       â””â”€â”€ ğŸ“„play.html
        â”‚   â”‚       â””â”€â”€ ğŸ“‚<ã„ã‚ã„ã‚>-practice
        â”‚   â”‚           â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.html
        â”‚   â”œâ”€â”€ ğŸ“‚tic_tac_toe1
        â”‚   â”‚   â””â”€â”€ ğŸ“„consumer1.py
        â”‚   â”œâ”€â”€ ğŸ“‚tic-tac-toe2
        â”‚   â”‚   â”œâ”€â”€ consumer1.py
        â”‚   â”‚   â””â”€â”€ protocol.py
        â”‚   â”œâ”€â”€ ğŸ“‚views
        â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“‚websocks
        â”‚   â”‚   â””â”€â”€ ğŸ“‚websock_practice1
        â”‚   â”‚       â””â”€â”€ ğŸ“‚v1
        â”‚   â”‚           â””â”€â”€ ğŸ“„consumer.py
        â”‚   â”œâ”€â”€ ğŸ“„admin.py
        â”‚   â”œâ”€â”€ ğŸ“„asgi.py
        â”‚   â”œâ”€â”€ ğŸ“„routing1.py
        â”‚   â”œâ”€â”€ ğŸ“„settings.py
        â”‚   â”œâ”€â”€ ğŸ“„urls.py
        â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
        â”œâ”€â”€ ğŸ“„.env
        â”œâ”€â”€ ğŸ³docker-compose.yml
        â”œâ”€â”€ ğŸ³Dockerfile
        â”œâ”€â”€ ğŸ“„manage.py
        â”œâ”€â”€ ğŸ“„requirements.txt
        â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
```

# Step 1. Dockerã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•

ï¼ˆã—ã¦ã„ãªã‘ã‚Œã°ï¼‰ Docker ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¦ãŠã„ã¦ã»ã—ã„  

```shell
# docker-compose.yml ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã¸ç§»å‹•ã—ã¦ã»ã—ã„
cd host1

# Docker ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•
docker-compose up
```

# Step 2. ãƒ¢ãƒ‡ãƒ«ä½œæˆ - m_member.py ãƒ•ã‚¡ã‚¤ãƒ«

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã»ã—ã„  

```plaintext
    â””â”€â”€ ğŸ“‚host1
        â””â”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
            â””â”€â”€ ğŸ“‚models
ğŸ‘‰              â””â”€â”€ ğŸ“„m_room.py
```

```py
# See also: https://qiita.com/zaburo/items/ab7f0eeeaec0e60d6b92
from django.db import models


class Room(models.Model):
    """éƒ¨å±‹ã®ãƒ¢ãƒ‡ãƒ«"""

    # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ä»•æ§˜ã‚’æ±ºã‚ã‚‹æ„Ÿã˜ã§

    # éƒ¨å±‹å
    # -----
    # Example: Elephant
    name = models.CharField('éƒ¨å±‹å', max_length=25)

    # å¯¾å±€è€…_å…ˆæ‰‹Id
    # ------------
    # Example: 1
    sente_id = models.IntegerField('å¯¾å±€è€…_å…ˆæ‰‹Id', null=True, blank=True)

    # å¯¾å±€è€…_å¾Œæ‰‹Id
    # ------------
    # Example: 2
    gote_id = models.IntegerField('å¯¾å±€è€…_å¾Œæ‰‹Id', null=True, blank=True)

    # ç›¤é¢
    # ----
    # Example: ..O.X.X..
    # +--+--+--+
    # |  |  | O|
    # +--+--+--+
    # |  | X|  |
    # +--+--+--+
    # | X|  |  |
    # +--+--+--+
    board = models.CharField('ç›¤é¢', max_length=9)

    # æ£‹è­œ
    # ----
    # Example: 426
    record = models.CharField('æ£‹è­œ', max_length=9)

    def __str__(self):
        """ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–‡å­—åˆ—ã«ã—ãŸã¨ãè¿”ã‚‹ã‚‚ã®"""
        return self.name
```

# Step 3. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ

```shell
# docker-compose.yml ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã¸ç§»å‹•ã—ã¦ã»ã—ã„
cd host1

docker-compose run --rm web python3 manage.py makemigrations webapp1
#                                                            -------
#                                                            1
# 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼å
```

ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹  

```plaintext
    â””â”€â”€ ğŸ“‚host1
        â””â”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
            â”œâ”€â”€ ğŸ“‚migrations
            â”‚   â”œâ”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
ğŸ‘‰          â”‚   â””â”€â”€ ğŸ“„0003_room.py          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯å¤‰ã‚ã‚Šã¾ã™
            â””â”€â”€ ğŸ“‚models
                â””â”€â”€ ğŸ“„m_room.py
```

ğŸ‘† ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚¡ã‚¤ãƒ« ã¨å‘¼ã¶ã‚‰ã—ã„  

# Step 4. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œï¼œãã®ï¼’ï¼

```shell
docker-compose run --rm web python manage.py migrate
```

ğŸ‘† ã“ã“ã¾ã§ã‚„ã£ã¦ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ã¨ã„ã†ä½œæ¥­ãŒçµ‚ã‚ã‚‹ã‚‰ã—ã„  

# Step 5. admin.py ã‚’ç·¨é›†

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¦ã»ã—ã„  

```plaintext
    â””â”€â”€ ğŸ“‚host1
        â””â”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
            â”œâ”€â”€ ğŸ“‚migrations
            â”‚   â”œâ”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
            â”‚   â””â”€â”€ ğŸ“„0003_room.py
            â”œâ”€â”€ ğŸ“‚models
            â”‚   â””â”€â”€ ğŸ“„m_room.py
ğŸ‘‰          â””â”€â”€ ğŸ“„admin.py
```

ğŸ‘‡ è¿½åŠ ã—ãŸã‚‚ã®ã ã‘ç¤ºã™  

```py
# å†’é ­
from .models.m_room import Room

# ...ä¸­ç•¥...

# Register your models here.
admin.site.register(Room)
```

ğŸ‘† ç®¡ç†ç”»é¢ã« Room ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã€‚  

# Step 6. ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§Webã®ç®¡ç†ç”»é¢ã¸ã‚¢ã‚¯ã‚»ã‚¹

```shell
# Dockerã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•
docker-compose up
```

ğŸ“– [http://localhost:8000/admin](http://localhost:8000/admin)  

ç”»é¢å·¦ã«

```plain
WEBAPP1
Members  +Add âœChange
Desserts +Add âœChange
Rooms    +Add âœChange
```

ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OKã€‚  
ã•ã‚Œã¦ã„ãªã‘ã‚Œã°ã€ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ç›´ã—ã¦ã»ã—ã„ã€‚  

# Step 7. Room ã‚’ï¼“ã¤ã»ã©è¿½åŠ ã—ã¦ã»ã—ã„

`Rooms    +Add` ã®å³å´ã® `+Add` ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã»ã—ã„ã€‚  

```plaintext
éƒ¨å±‹å:
      ----------------

å¯¾å±€è€…_å…ˆæ‰‹Id:
             ----------------

å¯¾å±€è€…_å¾Œæ‰‹Id:
             ----------------

ç›¤é¢:
    ----------------

æ£‹è­œ:
    ----

                [Save and add another] [Save and continue editing] [SAVE]
```

ğŸ‘†å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ãŒå‡ºã¦ãã‚‹ã‹ã‚‰ã€ï¼“ä»¶ã»ã©é©å½“ã«è¿½åŠ ã—ã¦ã»ã—ã„ã€‚  

å…¥åŠ›ä¾‹:  

```plaintext
éƒ¨å±‹å        å¯¾å±€è€…_å…ˆæ‰‹Id  å¯¾å±€è€…_å¾Œæ‰‹Id  ç›¤é¢       æ£‹è­œ
-----------  ------------  ------------  ---------  ---------
Elephant                1             2  XOXOXOXOX  012345678
Giraffe                 3             4  XOXOXOXOX  012345678
Lion                    5             6  XOXOXOXOX  012345678
```

`[SAVE]` ãŒè¿½åŠ ãƒœã‚¿ãƒ³ã®ã‚ˆã†ã ã€‚  

# Step 8. ç™»éŒ²ã—ãŸ Room ã‚’ç¢ºèªã—ã¦ã»ã—ã„

`Rooms    +Add` ã® `Rooms` ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ä¸€è¦§ç”»é¢ãŒå‡ºã¦ãã‚‹ã€‚  

# æ¬¡ã®è¨˜äº‹

ğŸ“– [Djangoã§ã‚²ãƒ¼ãƒ å¯¾å±€éƒ¨å±‹ã‚’ä¸€è¦§ã—ã‚ˆã†ï¼](https://qiita.com/muzudho1/items/346c286d4f99850afe23)  
