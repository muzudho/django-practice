# ç›®çš„

ã‚²ãƒ¼ãƒ å¯¾å±€éƒ¨å±‹ã«å…¥ã‚‹ã¨ãã¯ Room ãƒ¢ãƒ‡ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã® sente ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã« è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼Idã‚’ä¸Šæ›¸ãã—ã€  
è‡ªåˆ†ã® Profile ãƒ¬ã‚³ãƒ¼ãƒ‰ã® match_state ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ 3 ï¼ˆå¯¾å±€ä¸­ï¼‰ã«ä¸Šæ›¸ãã—ãŸã„  
ï¼ˆãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ï¼‰  

ã‚²ãƒ¼ãƒ å¯¾å±€éƒ¨å±‹ã‹ã‚‰å‡ºã‚‹ã¨ãã¯ Room ãƒ¢ãƒ‡ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã® sente ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç©ºã«ã—ã€  
è‡ªåˆ†ã® Profile ãƒ¬ã‚³ãƒ¼ãƒ‰ã® match_state ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ 0 ï¼ˆä¼‘æ†©ä¸­ï¼‰ã«ä¸Šæ›¸ãã—ãŸã„  
ï¼ˆãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆï¼‰  

# ã¯ã˜ã‚ã«

ã“ã®è¨˜äº‹ã¯ Lesson01 ã‹ã‚‰é †ã«å…¨éƒ¨ã‚„ã£ã¦ã“ãªã„ã¨ ã‚½ãƒ¼ã‚¹ãŒè¶³ã‚Šãšå®Ÿè¡Œã§ããªã„ã®ã§æ³¨æ„ã•ã‚ŒãŸã„ã€‚  
é€£è¼‰ã®ç›®æ¬¡: ğŸ“– [Djangoã¨Dockerã§ã‚²ãƒ¼ãƒ å¯¾å±€ã‚µãƒ¼ãƒãƒ¼ã‚’ä½œã‚ã†ï¼](https://qiita.com/muzudho1/items/eb0df0ea604e1fd9cdae)  

ã“ã®è¨˜äº‹ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:  

| Key       | Value                                     |
| --------- | ----------------------------------------- |
| OS        | Windows10                                 |
| Container | Docker                                    |
| Editor    | Visual Studio Code ï¼ˆä»¥ä¸‹ VSCode ã¨è¡¨è¨˜ï¼‰ |

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’æŠœç²‹ã™ã‚‹ã¨ ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚  

```plaintext
    â”œâ”€â”€ ğŸ“‚host_local1
    â”‚    â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
    â””â”€â”€ ğŸ“‚host1
        â”œâ”€â”€ ğŸ“‚data
        â”‚   â””â”€â”€ ğŸ“‚db
        â”‚       â””â”€â”€ ï¼ˆãŸãã•ã‚“ã®ã‚‚ã®ï¼‰
        â”œâ”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
        â”‚   â”œâ”€â”€ ğŸ“‚models
        â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“‚models_helper
        â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“‚static
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚allauth-customized
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚webapp1               # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¨åŒã˜åå‰
        â”‚   â”‚   â”‚   â””â”€â”€ ğŸ“‚practice
        â”‚   â”‚   â”‚       â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.js
        â”‚   â”‚   â””â”€â”€ ğŸš€favicon.ico
        â”‚   â”œâ”€â”€ ğŸ“‚templates
        â”‚   â”‚   â”œâ”€â”€ ğŸ“‚allauth-customized
        â”‚   â”‚   â””â”€â”€ ğŸ“‚webapp1               # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¨åŒã˜åå‰
        â”‚   â”‚       â”œâ”€â”€ ğŸ“‚tic-tac-toe
        â”‚   â”‚       â”‚   â”œâ”€â”€ ğŸ“‚v1
        â”‚   â”‚       â”‚   â””â”€â”€ ğŸ“‚v2
        â”‚   â”‚       â”‚       â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.html
        â”‚   â”‚       â””â”€â”€ ğŸ“‚<ã„ã‚ã„ã‚>-practice
        â”‚   â”‚           â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.html
        â”‚   â”œâ”€â”€ ğŸ“‚views
        â”‚   â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“‚websocks
        â”‚   â”‚   â””â”€â”€ ğŸ“‚tic_tac_toe
        â”‚   â”‚       â”œâ”€â”€ ğŸ“‚v1
        â”‚   â”‚       â””â”€â”€ ğŸ“‚v2
        â”‚   â”‚           â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>.py
        â”‚   â”œâ”€â”€ ğŸ“„admin.py
        â”‚   â”œâ”€â”€ ğŸ“„asgi.py
        â”‚   â”œâ”€â”€ ğŸ“„routing1.py
        â”‚   â”œâ”€â”€ ğŸ“„settings.py
        â”‚   â”œâ”€â”€ ğŸ“„urls.py
        â”‚   â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
        â”œâ”€â”€ ğŸ“„.env
        â”œâ”€â”€ ğŸ³docker-compose.yml
        â”œâ”€â”€ ğŸ³Dockerfile
        â”œâ”€â”€ ğŸ“„manage.py
        â”œâ”€â”€ ğŸ“„requirements.txt
        â””â”€â”€ ğŸ“„<ã„ã‚ã„ã‚>
```

# Step 1. Dockerã‚³ãƒ³ãƒ†ãƒŠã®èµ·å‹•

ï¼ˆã—ã¦ã„ãªã‘ã‚Œã°ï¼‰ Docker ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¦ãŠã„ã¦ã»ã—ã„  

```shell
# docker-compose.yml ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç½®ã„ã¦ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã¸ç§»å‹•ã—ã¦ã»ã—ã„
cd host1

# Docker ã‚³ãƒ³ãƒ†ãƒŠèµ·å‹•
docker-compose up
```

# Step 2. ãƒ—ãƒ­ãƒˆã‚³ãƒ«å®Ÿè£… - message_sender.js ãƒ•ã‚¡ã‚¤ãƒ«

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã»ã—ã„ã€‚  

```plaintext
    â””â”€â”€ ğŸ“‚host1
        â””â”€â”€ ğŸ“‚webapp1                       # ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼
            â””â”€â”€ ğŸ“‚static
                â””â”€â”€ ğŸ“‚webapp1
                    â””â”€â”€ ğŸ“‚tic-tac-toe
                        â””â”€â”€ ğŸ“‚v3
ğŸ‘‰                          â””â”€â”€ message_sender.js
```

```js
/**
 * ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§
 *
 * * ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã¸é€ã‚‹
 */
class MessageSenderV3 {
    /**
     * ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒéƒ¨å±‹ã«å…¥ã‚Šã¾ã™
     * @param {*} roomName - éƒ¨å±‹å
     * @param {*} myPiece - X ã‹ O
     * @param {*} userId - ãƒ¦ãƒ¼ã‚¶ãƒ¼Id
     * @returns ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    checkin(roomName, myPiece, userId) {
        // `c2s_` ã¯ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã¸é€ã‚‹å¤‰æ•°ã®ç›®å°
        return {
            c2s_event: "C2S_Checkin",
            c2s_roomName: roomName,
            c2s_myPiece: myPiece,
            c2s_userId: userId,
        };
    }

    /**
     * ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒéƒ¨å±‹ã‹ã‚‰å‡ºã¾ã™
     * @param {*} roomName - éƒ¨å±‹å
     * @param {*} myPiece - X ã‹ O
     * @param {*} userId - ãƒ¦ãƒ¼ã‚¶ãƒ¼Id
     * @returns ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
     */
    checkout(roomName, myPiece, userId) {
        // `c2s_` ã¯ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ã¸é€ã‚‹å¤‰æ•°ã®ç›®å°
        return {
            c2s_event: "C2S_Checkout",
            c2s_roomName: roomName,
            c2s_myPiece: myPiece,
            c2s_userId: userId,
        };
    }
}
```
