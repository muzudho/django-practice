{% load static %} {% comment %} üëà„ÅÇ„Å®„Åß static "URL" „Çí‰Ωø„ÅÜ„ÅÆ„Åß load static „Åó„Åæ„Åô {% endcomment %}
<!DOCTYPE html>
<html>
    <head>
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/@mdi/font@6.x/css/materialdesignicons.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />
        <title>Tic Tac Toe</title>
    </head>
    <body>
        <div id="app">
            <v-app>
                <v-main>
                    <v-container>
                        <h1>TIC TAC TOE</h1>
                        <h3>Welcome to room_{{room_name}}</h3>
                    </v-container>

                    <form name="form1" method="POST">
                        {% csrf_token %}
                        <v-container>
                            <v-row justify="center" dense>
                                <v-col>
                                    {% comment %} Vue „Åß‰∫åÈáçÊ≥¢Êã¨ÂºßÔºàbracesÔºâ„ÅØÂ§âÊï∞„ÅÆÂ±ïÈñã„Å´‰Ωø„Å£„Å¶„ÅÑ„Çã„Åì„Å®„Åã„Çâ„ÄÅ Python „ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å´‰∫åÈáçÊ≥¢Êã¨Âºß„ÇíÂ§âÊï∞„ÅÆÂ±ïÈñã„Å´‰Ωø„Çè„Å™„ÅÑ„Çà„ÅÜ verbatim „ÅßÊåáÁ§∫„Åó„Åæ„Åô„ÄÇ {% endcomment %} {% verbatim %}
                                    <v-btn id="square0" v-on:click="clickSquareV(0)">{{labelsOfPiece[0]}}</v-btn>
                                    <v-btn id="square1" v-on:click="clickSquareV(1)">{{labelsOfPiece[1]}}</v-btn>
                                    <v-btn id="square2" v-on:click="clickSquareV(2)">{{labelsOfPiece[2]}}</v-btn>
                                    {% endverbatim %}
                                </v-col>
                            </v-row>
                            <v-row justify="center" dense>
                                <v-col>
                                    {% verbatim %}
                                    <v-btn id="square3" v-on:click="clickSquareV(3)">{{labelsOfPiece[3]}}</v-btn>
                                    <v-btn id="square4" v-on:click="clickSquareV(4)">{{labelsOfPiece[4]}}</v-btn>
                                    <v-btn id="square5" v-on:click="clickSquareV(5)">{{labelsOfPiece[5]}}</v-btn>
                                    {% endverbatim %}
                                </v-col>
                            </v-row>
                            <v-row justify="center" dense>
                                <v-col>
                                    {% verbatim %}
                                    <v-btn id="square6" v-on:click="clickSquareV(6)">{{labelsOfPiece[6]}}</v-btn>
                                    <v-btn id="square7" v-on:click="clickSquareV(7)">{{labelsOfPiece[7]}}</v-btn>
                                    <v-btn id="square8" v-on:click="clickSquareV(8)">{{labelsOfPiece[8]}}</v-btn>
                                    {% endverbatim %}
                                </v-col>
                            </v-row>
                        </v-container>
                        <input type="hidden" name="room_name" value="{{room_name}}" />
                        <input type="hidden" name="my_piece" value="{{my_piece}}" />
                    </form>
                    <v-container>
                        <v-alert type="success" id="alert_your_move">Your turn. Place your move <strong>{{my_piece}}</strong></v-alert>
                    </v-container>
                </v-main>
            </v-app>
        </div>

        <script src="{% static 'tic-tac-toe2/connection.js' %}"></script>
        <script src="{% static 'tic-tac-toe2/protocol.js' %}"></script>
        <script src="{% static 'tic-tac-toe2/game.js' %}"></script>

        <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
        <script>
            let connection1 = new Connection();
            let game1 = new Game();

            let vue1 = new Vue({
                el: "#app",
                vuetify: new Vuetify(),
                data: {
                    labelsOfPiece: ["", "", "", "", "", "", "", "", ""],
                },
                // page loaded
                mounted: () => {
                    protocol_setup();
                },
                methods: {
                    // function to reset the game.
                    reset() {
                        console.log("[Debug] Vue#reset()");

                        game1.reset();

                        document.getElementById("alert_your_move").style.display = "block";

                        // „Éú„Çø„É≥„ÅÆ„É©„Éô„É´„Çí„ÇØ„É™„Ç¢„Éº
                        for (let sq = 0; sq < BOARD_AREA; sq += 1) {
                            this.setPieceV(sq, "");
                        }
                    },
                    /**
                     * Âçá„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç
                     * @param {*} sq - Square; 0 <= sq
                     */
                    clickSquareV(sq) {
                        console.log(`[Debug] Vue#clickSquare sq=${sq}`);
                        if (game1.board[sq] == PC_EMPTY) {
                            if (!game1.myTurn) {
                                alert("Wait for other to place the move");
                            } else {
                                game1.myTurn = false;
                                document.getElementById("alert_your_move").style.display = "none"; // Hide
                                game1.makeMove(parseInt(sq), connection1.myPiece);
                            }
                        }
                    },
                    setPieceV(sq, piece) {
                        // alert(`[Debug] Vue#setPieceV sq=${sq} piece=${piece} this.labelsOfPiece=${this.labelsOfPiece}`);
                        this.labelsOfPiece[sq] = piece;
                    },
                },
            });
        </script>
    </body>
</html>
